### 序列构成的数组

Python 标准库用c实现了丰富的序列类型。

最重要也最基础的序列类型应该就是列表`list`了，`list`是一个可变序列，并且能同时存放不同类型的元素。

列表推导（list comprehension），生成器表达式（generator expression）。

列表推导是构建列表`list`的快捷方式，而生成器表达式则可以用来创建其他任何类型的序列。

列表推导ex:

```
codes = [ord(a) for a in as]
```

为了防止列表推导被滥用，通常的原则是，只用列表推导来创建新的列表，并且尽量保持简短。

列表推导可以帮助我们把一个序列或是其他可迭代类型中的元素过滤或是加工，然后再新建一个列表。

列表推导的作用只有一个：生成列表。如果想生成其他类型的序列，生成器表达式就派上用场了。

虽然也可以用列表推导来初始化元组、数组或其他序列类型，但是生成器表达式是更好的选择。这是因为生成器表达式背后遵循了迭代器协议，可以逐个产出元素，而不是先建立一个完整的列表，然后再把这个列表传递到某个构造函数里。

生成器表达式的语法跟列表推导差不多，只不过把方括号换成圆括号而已。

```Python
>>> tuple(ord(a) for a in as)
```

元组（tuple）不仅仅是不可变列表。

`tuple`除了用作不可变的列表，还可以用于没有字段名的记录。

元组其实是对数据的记录：元组中的每个元素都存放了记录中一个字段的数据，外加这个字段的位置。正是这个位置信息给数据赋予了意义。

python 中`_`用作占位符。

在元组拆包中使用`*`可以帮我们把注意力集中在元组的部分元素上。

用`*`来处理剩下的元素。

在python 中，函数用`*args`来获取不确定数量的参数.

元组已经设计的很好用了，但是作为记录来用的话，还是少了一个功能：我们时常需要给记录中的字段命名。`namedtuple`函数的出现帮我们解决了这个问题。

`collections.namedtuple`是一个工厂函数，它可以用来构建一个带字段名的元组和一个有名字的类——这个带名字的类对调试程序有很大帮助。

用`namedtuple`构建的类的实例所消耗的内存跟元组是一样的，因为字段名都被存在对应的类中。这个实例跟普通的对象实例比起来要小一些，因为python不用`__dict__`来存放这些实例的属性。

不要把可变对象放在元组里面。

增量赋值（`+=`）不是一个原子操作。

#### `list.sort`方法和内置函数`sorted`

`list.sort`方法会就地排序列表，也就是说不会把原列表复制一份。这也是这个方法的返回值为`None`的原因，提醒你本方法不会新建一个列表。

Python 的一个惯例：如果一个函数或者方法对对象进行的是就地改动，那它就应该返回`None`，好让调用者知道传入的参数发生了变动，而且并未产生新的对象。

与`list.sort`相反的是内置函数`sorted`，它会新建一个列表作为返回值。这个方法可以接受任何形式的可迭代对象作为参数，甚至包括不可变序列或生成器。而不管`sorted`接受的是怎样的参数，它最后都会返回一个列表。

虽然列表既灵活又简单，但面对各类需求时，我们可能会有更好的选择。如：要存放1000万个浮点数的话，数组（`array`）的效率要高的多，因为数组在背后存的并不是`float`对象，而是数字的机器翻译，也就是字节表述。这一点就跟c语言中的数组一样。如果要频繁对序列做先进先出的操作，`deque`（双端队列）的速度应该会更快。

如果在你的代码中，包含操作（检查一个元素是否出现在一个集合中）的频率很高，用`set`（集合）会更合适。`set`专为检查元素是否存在做过优化，但它并不是序列，因为`set`是无序的。

#### 数组

如果我们需要一个只包含数字的列表，那么`array.array`比`list`更高效。数组支持所有跟可变序列有关的操作，包括`.pop`，`.insert`，`.extend`。另外数组还提供从文件读取和存入文件的更快的方法，如`.frombytes`和`.tofile`。

创建数组需要一个类型码，这个类型码用来表示在底层的c语言应该存放怎样的数据类型。Python 不会允许你在数组里存放除指定类型之外的数据。

知识点：一个快速序列化数字类型的方法是使用`pickle`模块。`pickle.dump`处理浮点数组的速度几乎跟`array.tofile`一样快。不过前者可以处理几乎所有的内置数字类型，包含复数、嵌套集合，甚至用户自定义的类。前提是这些类没有什么特别复杂的实现。

`collections.deque`类（双向队列）是一个线程安全、可以快速从两端添加或删除元素的数据类型。而且如果想要有一种数据类型来存放“最近用到的几个元素”，`deque`也是一个很好的选择。这是因为在新建一个双向队列的时候，你可以指定这个队列的大小，如果这个队列满了，还可以从反向端删除过期的元素，然后在尾端添加新的元素。
